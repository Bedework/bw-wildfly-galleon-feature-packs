function insertBwEvents(outputContainerID,bwObject,options){const outputContainer=document.getElementById(outputContainerID);let output="";const eventlist=[];let eventIndex=0;let bwListOptions;const defaults={calendarServer:"",calSuiteContext:"/cal",displayContactInDetails:true,displayCostInDetails:true,displayDayNameInList:false,displayDayNameTruncated:true,displayDescription:false,displayEndDateInList:true,displayEventDetailsInline:false,displayImageInList:false,displayLocationInList:false,displayNoEventText:true,displayTagsInDetails:true,displayTimeInList:true,displayTimezoneInDetails:true,displayTopicalAreasInList:false,displayThumbnailInList:false,eventImagePrefix:"/pubcaldav",limit:5,limitList:false,listMode:"byTitle",locationTitle:"Location:",noEventsText:"No events to display",showCount:true,showTitle:true,showTitleWhenNoEvents:true,suppressEndDateInList:false,suppressStartDateInList:false,thumbWidth:80,title:"Upcoming Events",topicalAreasTitle:"Topical Areas:",untilText:"Ends",useContentDiv:false,useFullImageThumbs:true,useImageDiv:false,usePlaceholderThumb:false};if(typeof options=="object"){for(const key in options){if(options.hasOwnProperty(key))defaults[key]=options[key]}}bwListOptions=defaults;if(bwObject===undefined||bwObject.bwEventList===undefined||bwObject.bwEventList.events===undefined||bwObject.bwEventList.events.length===0){if(bwListOptions.showTitleWhenNoEvents){output+='<h3 class="bwEventsTitle">'+bwListOptions.title+"</h3>"}if(bwListOptions.displayNoEventText){output+='<ul class="bwEventList"><li>'+bwListOptions.noEventsText+"</li></ul>"}}else{let i;const bwEventList=bwObject.bwEventList;for(i=0;i<bwEventList.events.length;i++){eventlist[eventIndex]=i;eventIndex++}if(bwListOptions.showTitle){output+='<h3 class="bwEventsTitle">';if(bwListOptions.showCaret){output+='<span class="caret caret-right"> </span>'}output+=bwListOptions.title;if(bwListOptions.showCount){output+=' <span class="bwEventsCount">('+bwEventList.resultSize+")</span>"}output+="</h3>"}output+='<ul class="bwEventList">';for(i in eventlist){if(bwListOptions.limitList&&bwListOptions.limit===i){break}const event=bwEventList.events[eventlist[i]];if(event.status==="CANCELLED"){output+='<li class="bwStatusCancelled">'}else if(event.status==="TENTATIVE"){output+='<li class="bwStatusTentative">'}else{output+="<li>"}if(bwListOptions.useImageDiv){output+='<div class="bwEventImage">'}if(bwListOptions.displayThumbnailInList){output+=formatBwThumbnail(event,bwListOptions)}if(bwListOptions.displayImageInList){output+=formatBwImage(event,bwListOptions)}if(bwListOptions.useImageDiv){output+="</div>"}if(bwListOptions.useContentDiv){output+='<div class="bwEventContent">'}if(bwListOptions.listMode==="byDate"){output+=formatBwDateTime(event,bwListOptions)+"<br/>"+formatBwSummary(event,outputContainerID,i,bwListOptions)}else{output+=formatBwSummary(event,outputContainerID,i,bwListOptions)+"<br/>"+formatBwDateTime(event,bwListOptions)}if(bwListOptions.displayLocationInList){output+='<div class="bwLoc">'+'<span class="bwLocTitle">'+bwListOptions.locationTitle+"</span> "+event.location.address+"</div>"}if(bwListOptions.displayDescription){output+='<div class="bwEventDescription"><p>'+event.description.replace(/\n/g,"<br />")+"</p></div>"}if(bwListOptions.displayTopicalAreasInList){output+='<div class="bwTopicalAreas">'+'<span class="bwTaTitle">'+bwListOptions.topicalAreasTitle+"</span> ";for(const j in event.xproperties){if(event.xproperties[j]["X-BEDEWORK-ALIAS"]!==undefined){if(event.xproperties[j]["X-BEDEWORK-ALIAS"].parameters["X-BEDEWORK-PARAM-DISPLAYNAME"]!==undefined){output+=event.xproperties[j]["X-BEDEWORK-ALIAS"].parameters["X-BEDEWORK-PARAM-DISPLAYNAME"]+", "}}}if(output.endsWith(", ")){output=output.substring(0,output.length-2)}output+="</div>"}if(bwListOptions.useContentDiv){output+="</div>"}output+="</li>"}output+="</ul>"}outputContainer.innerHTML=output}function formatBwThumbnail(event,bwListOptions){let output="";let bwEventLink="";let imgPrefix="";let imgSrc="";let imgObj;let thumbObj;for(const i in event.xproperties){if(event.xproperties[i]["X-BEDEWORK-THUMB-IMAGE"]!==undefined){thumbObj=event.xproperties[i]["X-BEDEWORK-THUMB-IMAGE"]}if(event.xproperties[i]["X-BEDEWORK-IMAGE"]!==undefined){imgObj=event.xproperties[i]["X-BEDEWORK-IMAGE"]}}if(thumbObj!==undefined){if(!thumbObj.values.text.startsWith("http")){imgPrefix=bwListOptions.eventImagePrefix}imgSrc=imgPrefix+thumbObj.values.text.trim()}else if(imgObj!==undefined&&bwListOptions.useFullImageThumbs){if(!imgObj.values.text.startsWith("http")){imgPrefix=bwListOptions.eventImagePrefix}imgSrc=imgPrefix+imgObj.values.text.trim()}else if(bwListOptions.usePlaceholderThumb){imgSrc="/images/calpublic/placeholder.png"}if(imgSrc!==""){if(!imgSrc.startsWith("http")){imgSrc=bwListOptions.calendarServer+imgSrc}bwEventLink=getBwEventLink(event,bwListOptions);output+='<a href="'+bwEventLink+'">'+'<img class="eventThumb img-responsive" width="'+bwListOptions.thumbWidth+'" src="'+imgSrc+'" alt="'+event.summary+'"/>'+"</a>"}return output}function formatBwImage(event,bwListOptions){let output="";let bwEventLink="";let imgPrefix="";let imgSrc="";let imgObj;let imgAlt;for(const i in event.xproperties){if(event.xproperties[i]["X-BEDEWORK-IMAGE"]!==undefined){imgObj=event.xproperties[i]["X-BEDEWORK-IMAGE"]}}if(imgObj!==undefined){if(!imgObj.values.text.startsWith("http")){imgPrefix=bwListOptions.eventImagePrefix}imgSrc=imgPrefix+imgObj.values.text.trim();if(imgObj.parameters!==undefined){if(imgObj.parameters["X-BEDEWORK-PARAM-ALT"]!==undefined){imgAlt=imgObj.parameters["X-BEDEWORK-PARAM-ALT"]}}}if(imgSrc!==""){if(!imgSrc.startsWith("http")){imgSrc=bwListOptions.calendarServer+imgSrc}bwEventLink=getBwEventLink(event,bwListOptions);let alt;if(imgAlt!==undefined){alt=imgAlt}else{alt=event.summary}output+='<a href="'+bwEventLink+'">'+'<img class="eventImage img-responsive"'+' src="'+imgSrc+'"'+' alt="'+alt+'"'+"/>"+"</a>"}return output}function formatBwDateTime(event,bwListOptions){let output='<span class="bwDateTime">';if(bwListOptions.listMode==="byDate"){output+="<strong>"}if(!bwListOptions.suppressStartDateInList){if(bwListOptions.displayDayNameInList){if(bwListOptions.displayDayNameTruncated){output+=event.start.dayname.substring(0,3)}else{output+=event.start.dayname}output+=", "}output+=event.start.longdate;if(event.start.allday==="false"&&bwListOptions.displayTimeInList){output+=" "+event.start.time}}if(!bwListOptions.suppressEndDateInList){if(bwListOptions.suppressStartDateInList){output+=bwListOptions.untilText+" "}if(bwListOptions.displayEndDateInList){if(event.start.shortdate!==event.end.shortdate||bwListOptions.suppressStartDateInList){if(!bwListOptions.suppressStartDateInList){output+=" - "}if(bwListOptions.displayDayNameInList){if(bwListOptions.displayDayNameTruncated){output+=event.end.dayname.substring(0,3)}else{output+=event.end.dayname}output+=", "}output+=event.end.longdate;if(event.start.allday==="false"&&bwListOptions.displayTimeInList){output+=" "+event.end.time}}else if(event.start.allday==="false"&&bwListOptions.displayTimeInList&&event.start.time!==event.end.time){output+=" - "+event.end.time}}}if(bwListOptions.listMode==="byDate"){output+="</strong>"}output+="</span>";return output}function formatBwSummary(event,outputContainerID,i,bwListOptions){let output='<span class="bwSummary">';if(bwListOptions.listMode==="byTitle"){output+="<strong>"}if(bwListOptions.displayEventDetailsInline){output+="<a href=\"javascript:showBwEvent('"+outputContainerID+"',"+i+');">'+event.summary+"</a>"}else{const bwEventLink=getBwEventLink(event,bwListOptions);output+='<a href="'+bwEventLink+'">'+event.summary+"</a>"}if(bwListOptions.listMode==="byTitle"){output+="</strong>"}output+="</span>";return output}function getBwEventLink(event,bwListOptions){const urlPrefix=bwListOptions.calendarServer+bwListOptions.calSuiteContext+"/event/eventView.do";let eventQueryString="?subid="+event.subscriptionId+"&amp;calPath="+event.calPath+"&amp;guid="+event.guid+"&amp;recurrenceId="+event.recurrenceId;return urlPrefix+eventQueryString}function showBwEvent(outputContainerID,eventId,displayContact,displayCost,displayTags,displayTimezone){let displayContactInDetails=true;let displayCostInDetails=true;let displayTagsInDetails=true;let displayTimezoneInDetails=true;if(displayContact!==undefined&&displayContact.length){displayContactInDetails=displayContact}if(displayCost!==undefined&&displayCost.length){displayCostInDetails=displayCost}if(displayTags!==undefined&&displayTags.length){displayTagsInDetails=displayTags}if(displayTimezone!==undefined&&displayTimezone.length){displayTimezoneInDetails=displayTimezone}const outputContainer=document.getElementById(outputContainerID);const event=bwObject.bwEventList.events[eventId];let output='<h3 class="bwEventsTitle">'+event.summary+"</h3>"+'<div class="bwEventLogistics">'+'<div class="bwEventDateTime">'+event.start.longdate;if(event.start.allday==="false"){output+=" "+event.start.time;if(event.start.timezone!==event.end.timezone&&displayTimezoneInDetails){output+=" "+event.start.timezone}}if(event.start.shortdate!==event.end.shortdate){output+=" - "+event.end.longdate;if(event.start.allday==="false"){output+=" "+event.end.time;if(displayTimezoneInDetails){output+=" "+event.end.timezone}}}else if(event.start.allday==="false"&&event.start.time!==event.end.time){output+=" - "+event.end.time;if(displayTimezoneInDetails){output+=" "+event.end.timezone}}output+="</div>";output+='<div class="bwEventLoc">';if(event.location.link!==""){output+='<a href="'+event.location.link+'">'+event.location.address+"</a>"}else{output+=event.location.address}output+="</div>";output+='<div class="bwEventDesc">'+event.description.replace(/\n/g,"<br />")+"</div>";if(displayContactInDetails){output+='<div class="bwEventContact">';if(event.contact.link!==""){output+='Contact: <a href="'+event.contact.link+'">'+event.contact.name+"</a>"}else{output+="Contact: "+event.contact.name}output+="</div>"}if(event.cost!==""&&displayCostInDetails){output+='<div class="bwEventCost">'+"Cost: "+event.cost+"</div>"}if(event.categories!==""&&displayTagsInDetails){output+='<div class="bwEventCats">'+"Tags: "+event.categories+"</div>"}if(event.link!==""){output+='<div class="bwEventLink">'+"See: "+'<a href="'+event.link+'">'+event.link+"</a>"+"</div>"}output+="</div>";output+='<p class="bwEventsListLink">'+"<a href=\"javascript:insertBwEvents('"+outputContainerID+"')\">Return</a></p>";outputContainer.innerHTML=output}